<Window
    x:Class="PurpleReaction.ControlUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="PurpleReaction Control UI">

    <Grid Padding="20">
        <Grid.Resources>
            <SolidColorBrush x:Key="PrimaryBrush" Color="#5C3ED8" />
            <SolidColorBrush x:Key="PrimaryBorderBrush" Color="#7D66E3" />
            <SolidColorBrush x:Key="MutedBrush" Color="#6B7280" />
        </Grid.Resources>

        <Pivot>
            <PivotItem Header="Run">
                <Grid RowSpacing="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Spacing="4">
                        <TextBlock FontSize="24" FontWeight="SemiBold" Foreground="{StaticResource PrimaryBrush}" Text="PurpleReaction Control UI" />
                        <TextBlock
                            Foreground="{StaticResource MutedBrush}"
                            Text="Configure a run, then launch the timing-accurate fullscreen test process in run-once mode."
                            TextWrapping="Wrap" />
                    </StackPanel>

                    <Border
                        Grid.Row="1"
                        Padding="16"
                        BorderBrush="{StaticResource PrimaryBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="8">
                        <Grid RowSpacing="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" FontSize="18" FontWeight="SemiBold" Text="Run Settings" />

                            <StackPanel Grid.Row="1" Spacing="6">
                                <TextBlock Text="PurpleReaction.exe Path" />
                                <TextBox x:Name="ExePathTextBox" />
                            </StackPanel>

                            <Grid Grid.Row="2" ColumnSpacing="12" RowSpacing="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="6">
                                    <TextBlock Text="Min Delay (s)" />
                                    <TextBox x:Name="MinDelayTextBox" Text="2.0" />
                                </StackPanel>

                                <StackPanel Grid.Column="1" Spacing="6">
                                    <TextBlock Text="Max Delay (s)" />
                                    <TextBox x:Name="MaxDelayTextBox" Text="5.0" />
                                </StackPanel>

                                <StackPanel Grid.Column="2" Spacing="6">
                                    <TextBlock Text="Trials" />
                                    <TextBox x:Name="TrialsTextBox" Text="10" />
                                </StackPanel>
                            </Grid>

                            <StackPanel Grid.Row="3" Spacing="8">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Button
                                        x:Name="StartRunButton"
                                        MinWidth="220"
                                        Background="{StaticResource PrimaryBrush}"
                                        Foreground="White"
                                        Click="OnStartRunClicked"
                                        Content="Start Fullscreen Run" />
                                    <Button
                                        x:Name="ExportCsvButton"
                                        MinWidth="130"
                                        BorderBrush="{StaticResource PrimaryBrush}"
                                        BorderThickness="1"
                                        Click="OnExportCsvClicked"
                                        Content="Export CSV"
                                        IsEnabled="False" />
                                </StackPanel>
                                <TextBlock x:Name="StatusTextBlock" TextWrapping="Wrap" />
                            </StackPanel>
                        </Grid>
                    </Border>

                    <Border
                        Grid.Row="2"
                        Padding="16"
                        BorderBrush="{StaticResource PrimaryBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="8">
                        <Grid RowSpacing="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" FontSize="18" FontWeight="SemiBold" Text="Latest Result" />
                            <TextBlock x:Name="SummaryTextBlock" Grid.Row="1" Text="No run yet." />

                            <Grid Grid.Row="2" RowSpacing="8">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0" ColumnSpacing="16" Margin="8,0,24,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="70" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="110" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" FontWeight="SemiBold" Text="Trial" />
                                    <TextBlock Grid.Column="1" FontWeight="SemiBold" Text="Delay (s)" />
                                    <TextBlock Grid.Column="2" FontWeight="SemiBold" Text="Reaction (ms)" />
                                    <TextBlock Grid.Column="3" FontWeight="SemiBold" Text="False Start" />
                                </Grid>

                                <ListView
                                    x:Name="TrialsListView"
                                    Grid.Row="1"
                                    IsItemClickEnabled="False"
                                    SelectionMode="None"
                                    ScrollViewer.VerticalScrollMode="Enabled"
                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                    ScrollViewer.HorizontalScrollMode="Disabled"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                    PointerEntered="OnTrialsListPointerEntered">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="Padding" Value="0" />
                                            <Setter Property="MinHeight" Value="32" />
                                        </Style>
                                    </ListView.ItemContainerStyle>

                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid ColumnSpacing="16" Margin="8,0,24,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="70" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="110" />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Trial}" />
                                                <TextBlock Grid.Column="1" Text="{Binding RandomDelaySecondsDisplay}" />
                                                <TextBlock Grid.Column="2" Text="{Binding ReactionMsDisplay}" />
                                                <TextBlock Grid.Column="3" Text="{Binding FalseStartDisplay}" />
                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>
            </PivotItem>

            <PivotItem Header="About">
                <Border
                    Padding="24"
                    BorderBrush="{StaticResource PrimaryBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8">
                    <StackPanel Spacing="12">
                        <Image
                            Width="88"
                            Height="88"
                            HorizontalAlignment="Left"
                            Source="ms-appx:///Assets/appicon.jpg"
                            Stretch="UniformToFill" />
                        <TextBlock FontSize="24" FontWeight="SemiBold" Foreground="{StaticResource PrimaryBrush}" Text="About PurpleReaction" />
                        <TextBlock
                            Text="Team Arion PurpleReaction Copyright (c) 2026 Team Arion and Mark Yu."
                            TextWrapping="Wrap" />
                        <TextBlock x:Name="VersionTextBlock" Text="Version: -" />
                        <HyperlinkButton
                            Content="GitHub Repository"
                            NavigateUri="https://github.com/TeamArionSISHK/PurpleReaction" />
                    </StackPanel>
                </Border>
            </PivotItem>
        </Pivot>
    </Grid>
</Window>
